<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠ</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<style>
body { font-family:'Cairo',sans-serif; direction:rtl; margin:0; background: linear-gradient(180deg,#f7fbff,#ffffff);}
.app { max-width: 400px; margin:60px auto 0; padding:24px; }
.app-header { text-align:center; margin-bottom:24px; }
.app-header h1{ margin:0; background:linear-gradient(90deg,#4f46e5,#0ea5e9); -webkit-background-clip:text; color:transparent; font-weight:800; }
.app-header p { margin:8px 0 0 0; color:#6b7280; font-size:13px; }
.input-row { display:flex; flex-direction:column; gap:12px; margin-bottom:16px; }
.input-row input { padding:10px; border-radius:8px; border:1px solid #ccc; width:100%; box-sizing:border-box; }
button { padding:12px; border:none; border-radius:10px; cursor:pointer; font-weight:700; }
button.primary { background: linear-gradient(90deg,#4f46e5,#0ea5e9); color:#fff; transition:all 0.3s ease; }
button.primary:hover { transform:translateY(-2px); box-shadow:0 6px 15px rgba(79,70,229,0.4); }
button.yellow { background:#fbbf24; color:#fff; }
.note { text-align:center; margin-top:12px; color:#ef4444; }

/* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§ */
.bottom-nav { display:none; position: fixed; bottom:0; left:0; right:0; height:60px; background:#fff; display:flex; justify-content:space-around; align-items:center; box-shadow:0 -4px 15px rgba(0,0,0,0.08);}
.bottom-nav a { text-decoration:none; color:#6b7280; font-size:12px; display:flex; flex-direction:column; align-items:center;}
.bottom-nav a.active { color:#4f46e5; }
</style>
</head>
<body>

<div class="app">
  <div class="app-header">
    <h1>ğŸ“ Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠ Ø§Ù„Ø£Ù‡Ù„ÙŠØ©</h1>
    <p>Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2025-2026</p>
  </div>

  <div class="input-row">
    <input id="parentNumber" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±">
    <input id="studentCode" type="text" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨">
    <button class="primary" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
    <button class="yellow" onclick="window.location.href='forgot.html'">Ù†Ø³ÙŠØª Ø§Ù„ÙƒÙˆØ¯ØŸ</button>
  </div>

  <div id="message" class="note"></div>
</div>

<nav class="bottom-nav" id="bottomNav">
  <a href="account.html" class="nav-item"><span>Ø§Ù„Ø­Ø³Ø§Ø¨</span></a>
  <a href="grades.html" class="nav-item"><span>Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</span></a>
  <a href="notifications.html" class="nav-item"><span>Ø§Ù„ØªØ¨Ù„ÙŠØºØ§Øª</span></a>
</nav>

<script>
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù„Ø³Ø© Ø³Ø§Ø¨Ù‚Ø©
document.addEventListener('DOMContentLoaded', ()=>{
  const sessionStudent = sessionStorage.getItem('studentData');

  // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ù…Ø³Ø¨Ù‚Ù‹Ø§
  if(sessionStudent){
    document.getElementById('bottomNav').style.display = 'flex'; // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø§Ø±
    window.location.replace('account.html');
    return;
  }

  const loginBtn = document.getElementById('loginBtn');
  const msg = document.getElementById('message');

  loginBtn.addEventListener('click', async ()=>{
    msg.textContent = "";
    const parent = document.getElementById('parentNumber').value.trim();
    const code = document.getElementById('studentCode').value.trim();
    if(!parent || !code){ msg.textContent = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„"; return; }

    msg.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
    try{
      const student = await PortalAPI.findByParentAndCode(parent, code);

      if(!student){ msg.textContent = "âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©"; return; }

      sessionStorage.setItem('studentData', JSON.stringify(student));
      msg.textContent = "âœ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!";

      // Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ
      document.getElementById('bottomNav').style.display = 'flex';
      setTimeout(()=> window.location.replace('account.html'), 500);
    } catch(e){
      msg.textContent = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
      console.error(e);
    }
  });
});
</script>

</body>
</html>
